{"ast":null,"code":"import { DIRECTION } from '../../core/utils.js';\nimport '../../core/change-details.js';\nimport '../../core/holder.js';\n\nclass PatternCursor {\n  constructor(masked, pos) {\n    this.masked = masked;\n    this._log = [];\n    const {\n      offset,\n      index\n    } = masked._mapPosToBlock(pos) || (pos < 0 ? // first\n    {\n      index: 0,\n      offset: 0\n    } : // last\n    {\n      index: this.masked._blocks.length,\n      offset: 0\n    });\n    this.offset = offset;\n    this.index = index;\n    this.ok = false;\n  }\n\n  get block() {\n    return this.masked._blocks[this.index];\n  }\n\n  get pos() {\n    return this.masked._blockStartPos(this.index) + this.offset;\n  }\n\n  get state() {\n    return {\n      index: this.index,\n      offset: this.offset,\n      ok: this.ok\n    };\n  }\n\n  set state(s) {\n    Object.assign(this, s);\n  }\n\n  pushState() {\n    this._log.push(this.state);\n  }\n\n  popState() {\n    const s = this._log.pop();\n\n    this.state = s;\n    return s;\n  }\n\n  bindBlock() {\n    if (this.block) return;\n\n    if (this.index < 0) {\n      this.index = 0;\n      this.offset = 0;\n    }\n\n    if (this.index >= this.masked._blocks.length) {\n      this.index = this.masked._blocks.length - 1;\n      this.offset = this.block.value.length;\n    }\n  }\n\n  _pushLeft(fn) {\n    this.pushState();\n\n    for (this.bindBlock(); 0 <= this.index; --this.index, this.offset = ((_this$block = this.block) === null || _this$block === void 0 ? void 0 : _this$block.value.length) || 0) {\n      var _this$block;\n\n      if (fn()) return this.ok = true;\n    }\n\n    return this.ok = false;\n  }\n\n  _pushRight(fn) {\n    this.pushState();\n\n    for (this.bindBlock(); this.index < this.masked._blocks.length; ++this.index, this.offset = 0) {\n      if (fn()) return this.ok = true;\n    }\n\n    return this.ok = false;\n  }\n\n  pushLeftBeforeFilled() {\n    return this._pushLeft(() => {\n      if (this.block.isFixed || !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.FORCE_LEFT);\n      if (this.offset !== 0) return true;\n    });\n  }\n\n  pushLeftBeforeInput() {\n    // cases:\n    // filled input: 00|\n    // optional empty input: 00[]|\n    // nested block: XX<[]>|\n    return this._pushLeft(() => {\n      if (this.block.isFixed) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.LEFT);\n      return true;\n    });\n  }\n\n  pushLeftBeforeRequired() {\n    return this._pushLeft(() => {\n      if (this.block.isFixed || this.block.isOptional && !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.LEFT);\n      return true;\n    });\n  }\n\n  pushRightBeforeFilled() {\n    return this._pushRight(() => {\n      if (this.block.isFixed || !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.FORCE_RIGHT);\n      if (this.offset !== this.block.value.length) return true;\n    });\n  }\n\n  pushRightBeforeInput() {\n    return this._pushRight(() => {\n      if (this.block.isFixed) return; // const o = this.offset;\n\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.NONE); // HACK cases like (STILL DOES NOT WORK FOR NESTED)\n      // aa|X\n      // aa<X|[]>X_    - this will not work\n      // if (o && o === this.offset && this.block instanceof PatternInputDefinition) continue;\n\n      return true;\n    });\n  }\n\n  pushRightBeforeRequired() {\n    return this._pushRight(() => {\n      if (this.block.isFixed || this.block.isOptional && !this.block.value) return; // TODO check |[*]XX_\n\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.NONE);\n      return true;\n    });\n  }\n\n}\n\nexport { PatternCursor as default };","map":{"version":3,"sources":["C:/Programacao/CCB/Web/node_modules/imask/esm/masked/pattern/cursor.js"],"names":["DIRECTION","PatternCursor","constructor","masked","pos","_log","offset","index","_mapPosToBlock","_blocks","length","ok","block","_blockStartPos","state","s","Object","assign","pushState","push","popState","pop","bindBlock","value","_pushLeft","fn","_this$block","_pushRight","pushLeftBeforeFilled","isFixed","nearestInputPos","FORCE_LEFT","pushLeftBeforeInput","LEFT","pushLeftBeforeRequired","isOptional","pushRightBeforeFilled","FORCE_RIGHT","pushRightBeforeInput","NONE","pushRightBeforeRequired","default"],"mappings":"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","sourcesContent":["import { DIRECTION } from '../../core/utils.js';\nimport '../../core/change-details.js';\nimport '../../core/holder.js';\n\nclass PatternCursor {\n  constructor(masked, pos) {\n    this.masked = masked;\n    this._log = [];\n    const {\n      offset,\n      index\n    } = masked._mapPosToBlock(pos) || (pos < 0 ?\n    // first\n    {\n      index: 0,\n      offset: 0\n    } :\n    // last\n    {\n      index: this.masked._blocks.length,\n      offset: 0\n    });\n    this.offset = offset;\n    this.index = index;\n    this.ok = false;\n  }\n  get block() {\n    return this.masked._blocks[this.index];\n  }\n  get pos() {\n    return this.masked._blockStartPos(this.index) + this.offset;\n  }\n  get state() {\n    return {\n      index: this.index,\n      offset: this.offset,\n      ok: this.ok\n    };\n  }\n  set state(s) {\n    Object.assign(this, s);\n  }\n  pushState() {\n    this._log.push(this.state);\n  }\n  popState() {\n    const s = this._log.pop();\n    this.state = s;\n    return s;\n  }\n  bindBlock() {\n    if (this.block) return;\n    if (this.index < 0) {\n      this.index = 0;\n      this.offset = 0;\n    }\n    if (this.index >= this.masked._blocks.length) {\n      this.index = this.masked._blocks.length - 1;\n      this.offset = this.block.value.length;\n    }\n  }\n  _pushLeft(fn) {\n    this.pushState();\n    for (this.bindBlock(); 0 <= this.index; --this.index, this.offset = ((_this$block = this.block) === null || _this$block === void 0 ? void 0 : _this$block.value.length) || 0) {\n      var _this$block;\n      if (fn()) return this.ok = true;\n    }\n    return this.ok = false;\n  }\n  _pushRight(fn) {\n    this.pushState();\n    for (this.bindBlock(); this.index < this.masked._blocks.length; ++this.index, this.offset = 0) {\n      if (fn()) return this.ok = true;\n    }\n    return this.ok = false;\n  }\n  pushLeftBeforeFilled() {\n    return this._pushLeft(() => {\n      if (this.block.isFixed || !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.FORCE_LEFT);\n      if (this.offset !== 0) return true;\n    });\n  }\n  pushLeftBeforeInput() {\n    // cases:\n    // filled input: 00|\n    // optional empty input: 00[]|\n    // nested block: XX<[]>|\n    return this._pushLeft(() => {\n      if (this.block.isFixed) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.LEFT);\n      return true;\n    });\n  }\n  pushLeftBeforeRequired() {\n    return this._pushLeft(() => {\n      if (this.block.isFixed || this.block.isOptional && !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.LEFT);\n      return true;\n    });\n  }\n  pushRightBeforeFilled() {\n    return this._pushRight(() => {\n      if (this.block.isFixed || !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.FORCE_RIGHT);\n      if (this.offset !== this.block.value.length) return true;\n    });\n  }\n  pushRightBeforeInput() {\n    return this._pushRight(() => {\n      if (this.block.isFixed) return;\n\n      // const o = this.offset;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.NONE);\n      // HACK cases like (STILL DOES NOT WORK FOR NESTED)\n      // aa|X\n      // aa<X|[]>X_    - this will not work\n      // if (o && o === this.offset && this.block instanceof PatternInputDefinition) continue;\n      return true;\n    });\n  }\n  pushRightBeforeRequired() {\n    return this._pushRight(() => {\n      if (this.block.isFixed || this.block.isOptional && !this.block.value) return;\n\n      // TODO check |[*]XX_\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.NONE);\n      return true;\n    });\n  }\n}\n\nexport { PatternCursor as default };\n"]},"metadata":{},"sourceType":"module"}