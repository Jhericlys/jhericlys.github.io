{"ast":null,"code":"var _jsxFileName = \"C:\\\\Programacao\\\\CCB\\\\Web\\\\src\\\\pages\\\\busca\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { useLocation, useSearchParams } from \"react-router-dom\";\nimport Navbar from '../../components/navbar';\nimport Estabelecimento from '../../components/estabelecimento';\nimport api from '../../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Busca() {\n  _s();\n\n  var _searchParams$get, _searchParams$get2;\n\n  const location = useLocation();\n  const [searchParams] = useSearchParams();\n  const [resultado, setResultado] = useState([]);\n  const [mais, setMais] = useState(true);\n  const [processando, setProcessando] = useState(false);\n  const [pagina, setPagina] = useState(1);\n  var id_categoria = searchParams.get('id_cat');\n  var id_banner = searchParams.get('id_banner');\n  var descricao = (_searchParams$get = searchParams.get('descr')) !== null && _searchParams$get !== void 0 ? _searchParams$get : 'Busca';\n  var busca = (_searchParams$get2 = searchParams.get('q')) !== null && _searchParams$get2 !== void 0 ? _searchParams$get2 : '';\n  var pg = 0;\n\n  function ListarEstabelecimentos(indReset) {\n    setProcessando(true);\n    pg = indReset ? 1 : pagina + 1;\n    api.get('/v1/estabelecimentos', {\n      params: {\n        cod_cidade: localStorage.getItem('sessionCodCidade'),\n        nome: busca,\n        id_categoria: id_categoria,\n        id_banner: id_banner,\n        pagina: pg\n      }\n    }).then(response => {\n      if (indReset) {\n        setResultado(response.data);\n        setPagina(1);\n      } else {\n        setResultado(oldArray => [...oldArray, ...response.data]);\n        setPagina(pagina + 1);\n      }\n\n      setProcessando(false);\n      setMais(response.data.length >= 10);\n    }).catch(err => {\n      console.log(err);\n      setProcessando(false);\n    });\n  }\n\n  useEffect(() => {\n    ListarEstabelecimentos(true);\n  }, [location]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid mt-page\",\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row m-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: descricao\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 13\n      }, this), busca.length > 0 ? /*#__PURE__*/_jsxDEV(\"small\", {\n        className: \"mb-4 text-secondary\",\n        children: [\"Pesquisando por: \", busca]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 33\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row m-2\",\n      children: resultado.map(estabelecimento => {\n        return /*#__PURE__*/_jsxDEV(Estabelecimento, {\n          url_imagem: estabelecimento.url_logo,\n          nome: estabelecimento.nome,\n          avaliacao: estabelecimento.avaliacao,\n          categoria: estabelecimento.categoria,\n          id_estabelecimento: estabelecimento.id_estabelecimento\n        }, estabelecimento.id_estabelecimento, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 28\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }, this), processando ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center m-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"spinner-grow spinner-grow-sm text-danger me-2\",\n        role: \"status\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-danger\",\n        children: \"Buscando restaurantes...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 27\n    }, this) : null, !processando && mais ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row m-4\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: e => ListarEstabelecimentos(false),\n        className: \"btn btn-outline-danger\",\n        children: \"Ver mais restaurantes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 34\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 12\n  }, this);\n}\n\n_s(Busca, \"JPnc0cvGZkxnOjOnLdlT/LPE6RQ=\", false, function () {\n  return [useLocation, useSearchParams];\n});\n\n_c = Busca;\nexport default Busca;\n\nvar _c;\n\n$RefreshReg$(_c, \"Busca\");","map":{"version":3,"sources":["C:/Programacao/CCB/Web/src/pages/busca/index.jsx"],"names":["useEffect","useState","useLocation","useSearchParams","Navbar","Estabelecimento","api","Busca","location","searchParams","resultado","setResultado","mais","setMais","processando","setProcessando","pagina","setPagina","id_categoria","get","id_banner","descricao","busca","pg","ListarEstabelecimentos","indReset","params","cod_cidade","localStorage","getItem","nome","then","response","data","oldArray","length","catch","err","console","log","map","estabelecimento","url_logo","avaliacao","categoria","id_estabelecimento","e"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useLocation, useSearchParams } from \"react-router-dom\";\r\nimport Navbar from '../../components/navbar';\r\nimport Estabelecimento from '../../components/estabelecimento';\r\nimport api from '../../services/api';\r\n\r\nfunction Busca(){\r\n    \r\n    const location = useLocation();\r\n    const [searchParams] = useSearchParams();\r\n    const [resultado, setResultado] = useState([]);\r\n    const [mais, setMais] = useState(true);\r\n    const [processando, setProcessando] = useState(false);\r\n    const [pagina, setPagina] = useState(1);    \r\n\r\n    var id_categoria = searchParams.get('id_cat');\r\n    var id_banner = searchParams.get('id_banner');\r\n    var descricao = searchParams.get('descr') ?? 'Busca';\r\n    var busca = searchParams.get('q') ?? '';\r\n    var pg = 0;\r\n\r\n    function ListarEstabelecimentos(indReset){\r\n\r\n        setProcessando(true);        \r\n\r\n        pg = indReset ? 1 : pagina + 1;\r\n\r\n        api.get('/v1/estabelecimentos', {\r\n            params: {\r\n                cod_cidade: localStorage.getItem('sessionCodCidade'),\r\n                nome: busca,\r\n                id_categoria: id_categoria,\r\n                id_banner: id_banner,\r\n                pagina: pg\r\n            }\r\n        })\r\n        .then( response => {   \r\n            if (indReset) {\r\n                setResultado(response.data);\r\n                setPagina(1);\r\n            } else {\r\n                setResultado((oldArray) => [...oldArray, ...response.data]);\r\n                setPagina(pagina + 1);\r\n            }\r\n            \r\n            setProcessando(false);            \r\n            setMais(response.data.length >= 10);\r\n        })\r\n        .catch(err => {\r\n            console.log(err);\r\n            setProcessando(false);\r\n        });\r\n    }\r\n\r\n    useEffect(() => {\r\n        ListarEstabelecimentos(true);\r\n    }, [location]);\r\n\r\n    return <div className=\"container-fluid mt-page\">\r\n        <Navbar/>\r\n\r\n        <div className=\"row m-2\">\r\n            <h3>{descricao}</h3>\r\n            {busca.length > 0 ? <small className=\"mb-4 text-secondary\">Pesquisando por: {busca}</small> : null}\r\n        </div>\r\n\r\n        <div className=\"row m-2\">\r\n            {\r\n                resultado.map(estabelecimento => {\r\n                    return <Estabelecimento \r\n                            key={estabelecimento.id_estabelecimento}\r\n                            url_imagem={estabelecimento.url_logo}\r\n                            nome ={estabelecimento.nome}\r\n                            avaliacao={estabelecimento.avaliacao}\r\n                            categoria={estabelecimento.categoria}\r\n                            id_estabelecimento={estabelecimento.id_estabelecimento}/> \r\n                })\r\n            }\r\n        </div>\r\n\r\n        {\r\n            processando ? <div className=\"text-center m-5\">\r\n                <span className=\"spinner-grow spinner-grow-sm text-danger me-2\" role=\"status\"></span>\r\n                <span className=\"text-danger\">Buscando restaurantes...</span>\r\n            </div> : null\r\n        }\r\n\r\n        { !processando && mais ? <div className=\"row m-4\">\r\n            <button onClick={(e) => ListarEstabelecimentos(false)} className=\"btn btn-outline-danger\">Ver mais restaurantes</button>\r\n            </div> : null\r\n        }\r\n\r\n    </div>\r\n}\r\n\r\nexport default Busca;"]},"metadata":{},"sourceType":"module"}