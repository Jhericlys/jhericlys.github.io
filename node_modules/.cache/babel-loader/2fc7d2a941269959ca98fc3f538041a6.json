{"ast":null,"code":"var _jsxFileName = \"C:\\\\Programacao\\\\CCB\\\\Web\\\\src\\\\components\\\\produto\\\\modal\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport { useContext, useEffect, useState } from \"react\";\nimport Modal from 'react-modal/lib/components/Modal';\nimport closeIcone from '../../../assets/close.png';\nimport ProdutoItemCheckbox from \"../produto-item-checkbox\";\nimport ProdutoItemRadio from \"../produto-item-radio\";\nimport api from '../../../services/api';\nimport './style.css';\nimport { CartContext } from \"../../../contexts/cart\";\nimport { v4 as uuidv4 } from 'uuid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction ProdutoModal(props) {\n  _s();\n\n  const {\n    cart,\n    AddItemCart\n  } = useContext(CartContext);\n  const [id_produto, setId_produto] = useState(0);\n  const [nome, setNome] = useState('');\n  const [descricao, setDescricao] = useState('');\n  const [vl_produto, setVl_produto] = useState(0);\n  const [vl_promocao, setVl_promocao] = useState(0);\n  const [url_foto, setUrl_foto] = useState('');\n  const [qtd, setQtd] = useState(1);\n  const [opcoes, setOpcoes] = useState([]);\n  const [grupos, setGrupos] = useState([]);\n  const [bloquearBtn, setBloquearBtn] = useState(true);\n  const [total, setTotal] = useState(0);\n  useEffect(() => {\n    if (props.id_produto <= 0) {\n      return;\n    }\n\n    api.get(`v1/produtos/${props.id_produto}`).then(response => {\n      setId_produto(props.id_produto);\n      setNome(response.data[0].nome);\n      setDescricao(response.data[0].descricao);\n      setVl_produto(response.data[0].vl_produto);\n      setVl_promocao(response.data[0].vl_promocao);\n      setUrl_foto(response.data[0].url_foto);\n      setQtd(1);\n      setTotal(response.data[0].vl_promocao > 0 ? response.data[0].vl_promocao : response.data[0].vl_produto);\n    }).catch(err => console.log(err));\n    api.get(`v1/cardapios/opcoes/${props.id_produto}`).then(response => {\n      setOpcoes(response.data);\n      let gruposUnico = response.data.map(g => {\n        return {\n          id_opcao: g.id_opcao,\n          id_produto: g.id_produto,\n          descricao: g.descricao,\n          ind_obrigatorio: g.ind_obrigatorio,\n          qtd_max_escolha: g.qtd_max_escolha,\n          ind_ativo: g.ind_ativo,\n          ordem: g.ordem,\n          selecao: []\n        };\n      });\n      gruposUnico = gruposUnico.filter((item, index, arr) => {\n        return arr.findIndex(t => {\n          return t.id_opcao === item.id_opcao;\n        }) === index;\n      });\n      setGrupos(gruposUnico);\n      HabilitaBotao(gruposUnico);\n    }).catch(err => console.log(err));\n  }, [props.isOpen]);\n\n  function ClickMais() {\n    setQtd(qtd + 1);\n  }\n\n  function ClickMenos() {\n    qtd > 1 ? setQtd(qtd - 1) : setQtd(1);\n  }\n\n  function AddItem() {\n    let detalhes = [];\n    let vl_detalhes = 0;\n    grupos.map(item => {\n      item.selecao.map(sel => {\n        vl_detalhes += sel.vl_item;\n        detalhes.push({\n          nome: sel.nome,\n          id_item: sel.id_item,\n          vl_item: sel.vl_item,\n          ordem: sel.ordem\n        });\n      });\n    });\n    const item = {\n      id_carrinho: uuidv4(),\n      id_produto: id_produto,\n      nome: nome,\n      descricao: nome,\n      qtd: qtd,\n      vl_unit: vl_detalhes + (vl_promocao > 0 ? vl_promocao : vl_produto),\n      vl_total: (vl_detalhes + (vl_promocao > 0 ? vl_promocao : vl_produto)) * qtd,\n      url_foto: url_foto,\n      detalhes: detalhes\n    };\n    console.log(item);\n    AddItemCart(item);\n    props.onRequestClose();\n  }\n\n  function SelecionaRadioButton(op) {\n    let g = grupos; // Descobrir o indice do grupo clicado...\n\n    let objIndex = g.findIndex(obj => obj.id_opcao == op.id_opcao); // Atualizar informacao do item naquele indice...\n\n    g[objIndex].selecao = [op];\n    setGrupos(g);\n    HabilitaBotao(g);\n    CalculaTotal(g);\n  }\n\n  function SelecionaCheckbox(isChecked, op) {\n    let g = grupos;\n    let s = []; // Descobrir o indice do grupo clicado...\n\n    let objIndex = g.findIndex(obj => obj.id_opcao == op.id_opcao); // Extrai os itens selecionados...\n\n    s = g[objIndex].selecao; // Verfificar se deve inserir ou remover um item...\n\n    if (isChecked) {\n      s.push(op);\n    } else {\n      let objIndexSel = s.findIndex(obj => obj.id_item == op.id_item);\n      s.splice(objIndexSel, 1);\n    }\n\n    g[objIndex].selecao = s;\n    setGrupos(g);\n    HabilitaBotao(g);\n    CalculaTotal(g);\n  }\n\n  function HabilitaBotao(grp) {\n    let bloquear = false;\n    grp.map(item => {\n      if (item.ind_obrigatorio == \"S\" && item.selecao.length == 0) {\n        bloquear = true;\n      }\n    });\n    setBloquearBtn(bloquear);\n  }\n\n  function CalculaTotal(grp) {\n    let vl_selecao = 0;\n    let vl_prod = vl_promocao > 0 ? vl_promocao : vl_produto;\n    grp.map(item => {\n      item.selecao.map(sel => {\n        //vl_selecao = vl_selecao + sel.vl_item;\n        vl_selecao += sel.vl_item;\n      });\n    });\n    setTotal((vl_selecao + vl_prod) * qtd);\n  }\n\n  useEffect(() => {\n    CalculaTotal(grupos);\n  }, [qtd]);\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    isOpen: props.isOpen,\n    onRequestClose: props.onRequestClose,\n    overlayClassName: \"react-modal-overlay\",\n    className: \"react-modal-content\",\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: props.onRequestClose,\n      className: \"react-modal-close\",\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: closeIcone,\n        alt: \"Fechar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid h-100 produto-modal\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row detalhes-produto\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"img-fluid rounded img-produto-modal\",\n            src: url_foto,\n            alt: \"Produto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"mt-2\",\n            children: nome\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n            className: \"d-block mb-3\",\n            children: descricao\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 21\n          }, this), vl_promocao > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"small\", {\n              className: \"mt-3 promocao\",\n              children: new Intl.NumberFormat('pt-BR', {\n                style: 'currency',\n                currency: 'BRL'\n              }).format(vl_promocao)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n              className: \"ms-4 mt-3 preco-antigo\",\n              children: new Intl.NumberFormat('pt-BR', {\n                style: 'currency',\n                currency: 'BRL'\n              }).format(vl_produto)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(\"small\", {\n            className: \"mt-3\",\n            children: new Intl.NumberFormat('pt-BR', {\n              style: 'currency',\n              currency: 'BRL'\n            }).format(vl_produto)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 mb-4\",\n          children: grupos.map(grupo => {\n            let op = opcoes.filter((item, index, arr) => {\n              return item.id_opcao == grupo.id_opcao;\n            });\n            return grupo.qtd_max_escolha == 1 ? /*#__PURE__*/_jsxDEV(ProdutoItemRadio, {\n              titulo: grupo.descricao,\n              obrigatorio: grupo.ind_obrigatorio == \"S\" ? true : false,\n              opcoes: op,\n              onClickItem: SelecionaRadioButton\n            }, grupo.id_opcao, false, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 37\n            }, this) : /*#__PURE__*/_jsxDEV(ProdutoItemCheckbox, {\n              titulo: grupo.descricao,\n              opcoes: op,\n              onClickItem: SelecionaCheckbox\n            }, grupo.id_opcao, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 34\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 mt-3 d-flex justify-content-end\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: ClickMenos,\n              className: \"btn btn-outline-danger\",\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-minus\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 89\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"m-3 button-qtd\",\n              children: qtd.toLocaleString('pt-BR', {\n                minimumIntegerDigits: 2\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: ClickMais,\n              className: \"btn btn-outline-danger\",\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-plus\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 88\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: AddItem,\n              className: \"btn btn-danger ms-4\",\n              disabled: bloquearBtn,\n              children: [\"Adicionar a sacola (\", new Intl.NumberFormat('pt-BR', {\n                style: 'currency',\n                currency: 'BRL'\n              }).format(total), \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 190,\n    columnNumber: 12\n  }, this);\n}\n\n_s(ProdutoModal, \"fOrVNmFsOAaUAZY07rkGI+M/U/E=\");\n\n_c = ProdutoModal;\nexport default ProdutoModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProdutoModal\");","map":{"version":3,"sources":["C:/Programacao/CCB/Web/src/components/produto/modal/index.jsx"],"names":["useContext","useEffect","useState","Modal","closeIcone","ProdutoItemCheckbox","ProdutoItemRadio","api","CartContext","v4","uuidv4","ProdutoModal","props","cart","AddItemCart","id_produto","setId_produto","nome","setNome","descricao","setDescricao","vl_produto","setVl_produto","vl_promocao","setVl_promocao","url_foto","setUrl_foto","qtd","setQtd","opcoes","setOpcoes","grupos","setGrupos","bloquearBtn","setBloquearBtn","total","setTotal","get","then","response","data","catch","err","console","log","gruposUnico","map","g","id_opcao","ind_obrigatorio","qtd_max_escolha","ind_ativo","ordem","selecao","filter","item","index","arr","findIndex","t","HabilitaBotao","isOpen","ClickMais","ClickMenos","AddItem","detalhes","vl_detalhes","sel","vl_item","push","id_item","id_carrinho","vl_unit","vl_total","onRequestClose","SelecionaRadioButton","op","objIndex","obj","CalculaTotal","SelecionaCheckbox","isChecked","s","objIndexSel","splice","grp","bloquear","length","vl_selecao","vl_prod","Intl","NumberFormat","style","currency","format","grupo","toLocaleString","minimumIntegerDigits"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState } from \"react\";\r\nimport Modal from 'react-modal/lib/components/Modal';\r\nimport closeIcone from '../../../assets/close.png';\r\nimport ProdutoItemCheckbox from \"../produto-item-checkbox\";\r\nimport ProdutoItemRadio from \"../produto-item-radio\";\r\nimport api from '../../../services/api';\r\nimport './style.css';\r\nimport { CartContext } from \"../../../contexts/cart\";\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nfunction ProdutoModal(props){\r\n    \r\n    const {cart, AddItemCart} = useContext(CartContext);\r\n\r\n    const [id_produto, setId_produto] = useState(0);\r\n    const [nome, setNome] = useState('');\r\n    const [descricao, setDescricao] = useState('');\r\n    const [vl_produto, setVl_produto] = useState(0);\r\n    const [vl_promocao, setVl_promocao] = useState(0);\r\n    const [url_foto, setUrl_foto] = useState('');\r\n    const [qtd, setQtd] = useState(1);\r\n\r\n    const [opcoes, setOpcoes] = useState([]);\r\n    const [grupos, setGrupos] = useState([]);\r\n    const [bloquearBtn, setBloquearBtn] = useState(true);\r\n    const [total, setTotal] = useState(0);\r\n\r\n    useEffect(() => {\r\n\r\n        if (props.id_produto <= 0){\r\n            return;\r\n        }\r\n\r\n        api.get(`v1/produtos/${props.id_produto}`)\r\n        .then(response => {\r\n            setId_produto(props.id_produto);\r\n            setNome(response.data[0].nome);\r\n            setDescricao(response.data[0].descricao);\r\n            setVl_produto(response.data[0].vl_produto);\r\n            setVl_promocao(response.data[0].vl_promocao);\r\n            setUrl_foto(response.data[0].url_foto);\r\n            setQtd(1);\r\n            setTotal(response.data[0].vl_promocao > 0 ? response.data[0].vl_promocao : response.data[0].vl_produto);\r\n        })\r\n        .catch(err => console.log(err));\r\n\r\n        api.get(`v1/cardapios/opcoes/${props.id_produto}`)\r\n        .then(response => {\r\n            setOpcoes(response.data);\r\n\r\n            let gruposUnico = response.data.map(g => {\r\n                return {\r\n                    id_opcao: g.id_opcao,\r\n                    id_produto: g.id_produto,\r\n                    descricao: g.descricao,\r\n                    ind_obrigatorio: g.ind_obrigatorio,\r\n                    qtd_max_escolha: g.qtd_max_escolha,\r\n                    ind_ativo: g.ind_ativo,\r\n                    ordem: g.ordem,\r\n                    selecao: [] \r\n                };\r\n            });\r\n\r\n            gruposUnico = gruposUnico.filter((item, index, arr) => {\r\n                return arr.findIndex((t) => {\r\n                    return t.id_opcao === item.id_opcao;\r\n                }) === index;\r\n            });\r\n                        \r\n            setGrupos(gruposUnico);            \r\n            HabilitaBotao(gruposUnico);\r\n        })\r\n        .catch(err => console.log(err));\r\n\r\n    }, [props.isOpen]);\r\n\r\n    function ClickMais(){\r\n        setQtd(qtd + 1);\r\n    }\r\n\r\n    function ClickMenos(){\r\n        qtd > 1 ? setQtd(qtd - 1) : setQtd(1);\r\n    }\r\n\r\n    function AddItem(){\r\n        let detalhes = [];\r\n        let vl_detalhes = 0;\r\n\r\n        grupos.map(item => {\r\n            item.selecao.map(sel => {\r\n                vl_detalhes += sel.vl_item;\r\n\r\n                detalhes.push({\r\n                    nome: sel.nome,\r\n                    id_item: sel.id_item,\r\n                    vl_item: sel.vl_item,\r\n                    ordem: sel.ordem\r\n                });\r\n            });\r\n        });\r\n\r\n\r\n\r\n        const item = {\r\n            id_carrinho: uuidv4(),\r\n            id_produto: id_produto,\r\n            nome: nome,\r\n            descricao: nome,\r\n            qtd: qtd,\r\n            vl_unit: vl_detalhes + (vl_promocao > 0 ? vl_promocao : vl_produto),\r\n            vl_total: (vl_detalhes + (vl_promocao > 0 ? vl_promocao : vl_produto)) * qtd,\r\n            url_foto: url_foto,\r\n            detalhes: detalhes\r\n        };\r\n\r\n        console.log(item);\r\n\r\n        AddItemCart(item);\r\n        props.onRequestClose();\r\n    }\r\n\r\n    function SelecionaRadioButton(op){        \r\n        let g = grupos;\r\n\r\n        // Descobrir o indice do grupo clicado...\r\n       let objIndex = g.findIndex(obj => obj.id_opcao == op.id_opcao); \r\n\r\n       // Atualizar informacao do item naquele indice...\r\n       g[objIndex].selecao = [op];\r\n\r\n       setGrupos(g);\r\n       HabilitaBotao(g);\r\n       CalculaTotal(g);\r\n    }\r\n\r\n    function SelecionaCheckbox(isChecked, op){\r\n        let g = grupos;\r\n        let s = [];\r\n\r\n        // Descobrir o indice do grupo clicado...\r\n       let objIndex = g.findIndex(obj => obj.id_opcao == op.id_opcao);\r\n\r\n       // Extrai os itens selecionados...\r\n       s = g[objIndex].selecao;\r\n              \r\n       // Verfificar se deve inserir ou remover um item...\r\n       if (isChecked){\r\n           s.push(op);\r\n       } else {\r\n           let objIndexSel = s.findIndex(obj => obj.id_item == op.id_item);\r\n           s.splice(objIndexSel, 1);\r\n       }\r\n\r\n       g[objIndex].selecao = s;\r\n       setGrupos(g);\r\n       HabilitaBotao(g);\r\n       CalculaTotal(g);\r\n    }\r\n   \r\n    function HabilitaBotao(grp){\r\n        let bloquear = false;\r\n        \r\n        grp.map(item => {\r\n            if (item.ind_obrigatorio == \"S\" && item.selecao.length == 0){\r\n                bloquear = true;\r\n            }\r\n        });\r\n\r\n        setBloquearBtn(bloquear);\r\n    }\r\n\r\n    function CalculaTotal(grp){\r\n        let vl_selecao = 0;\r\n        let vl_prod = vl_promocao > 0 ? vl_promocao : vl_produto;\r\n\r\n        grp.map(item => {\r\n            item.selecao.map(sel => {\r\n                //vl_selecao = vl_selecao + sel.vl_item;\r\n                vl_selecao += sel.vl_item;\r\n            });\r\n        });\r\n\r\n        setTotal((vl_selecao + vl_prod) * qtd);\r\n    }\r\n\r\n    useEffect(() => {\r\n        CalculaTotal(grupos);\r\n    }, [qtd]);\r\n\r\n    return <Modal isOpen={props.isOpen}\r\n                  onRequestClose={props.onRequestClose}\r\n                  overlayClassName=\"react-modal-overlay\"\r\n                  className=\"react-modal-content\">\r\n        \r\n        <button type=\"button\" onClick={props.onRequestClose} className=\"react-modal-close\">\r\n            <img src={closeIcone} alt=\"Fechar\" />\r\n        </button>\r\n\r\n        <div className=\"container-fluid h-100 produto-modal\">\r\n            <div className=\"row detalhes-produto\">\r\n                <div>\r\n                    <img className=\"img-fluid rounded img-produto-modal\" \r\n                         src={url_foto}\r\n                         alt=\"Produto\" />\r\n                </div>\r\n\r\n                <div className=\"col-12 mt-4\">\r\n                    <h4 className=\"mt-2\">{nome}</h4>\r\n                    <small className=\"d-block mb-3\">\r\n                        {descricao}\r\n                    </small>\r\n\r\n                    {\r\n                        vl_promocao > 0 ? <>\r\n                        <small className=\"mt-3 promocao\">\r\n                        {new Intl.NumberFormat('pt-BR', {style: 'currency',currency: 'BRL'}).format(vl_promocao)}\r\n                        </small>\r\n                        <small className=\"ms-4 mt-3 preco-antigo\">\r\n                        {new Intl.NumberFormat('pt-BR', {style: 'currency',currency: 'BRL'}).format(vl_produto)}\r\n                        </small></>\r\n                        :\r\n                        <small className=\"mt-3\">\r\n                        {new Intl.NumberFormat('pt-BR', {style: 'currency',currency: 'BRL'}).format(vl_produto)}\r\n                        </small>\r\n                    }\r\n                </div>\r\n\r\n                <div className=\"col-12 mb-4\">\r\n                    {\r\n                        grupos.map(grupo => {\r\n\r\n                            let op = opcoes.filter((item, index, arr) => {\r\n                                return item.id_opcao == grupo.id_opcao\r\n                            });\r\n\r\n                            return grupo.qtd_max_escolha == 1 ?\r\n                                    <ProdutoItemRadio key={grupo.id_opcao}\r\n                                                      titulo={grupo.descricao}\r\n                                                      obrigatorio={grupo.ind_obrigatorio == \"S\" ? true : false}\r\n                                                      opcoes={op}\r\n                                                      onClickItem={SelecionaRadioButton}\r\n                                                      />\r\n                                 :\r\n                                 <ProdutoItemCheckbox key={grupo.id_opcao}\r\n                                                      titulo={grupo.descricao}\r\n                                                      opcoes={op}\r\n                                                      onClickItem={SelecionaCheckbox}\r\n                                                       />\r\n                        })\r\n                                                            \r\n                    }\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"row\">\r\n                <div className=\"col-12 mt-3 d-flex justify-content-end\">\r\n                    <div>                    \r\n                        <button onClick={ClickMenos} className=\"btn btn-outline-danger\"><i className=\"fas fa-minus\"></i></button>\r\n                        <span className=\"m-3 button-qtd\">{qtd.toLocaleString('pt-BR', {\r\n                            minimumIntegerDigits: 2\r\n                        })}</span>\r\n                        <button onClick={ClickMais} className=\"btn btn-outline-danger\"><i className=\"fas fa-plus\"></i></button>\r\n\r\n                        <button onClick={AddItem} className=\"btn btn-danger ms-4\" disabled={bloquearBtn}>Adicionar a sacola (\r\n                            {new Intl.NumberFormat('pt-BR', {style: 'currency',currency: 'BRL'}).format(total)}\r\n                        )</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </Modal>\r\n}\r\n\r\nexport default ProdutoModal;"]},"metadata":{},"sourceType":"module"}